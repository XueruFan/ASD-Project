rm(list=ls())
packages <- c("ggplot2", "ggseg", "ggridges", "tidyr", "do", "dplyr", "Cairo", "openxlsx")
# sapply(packages, install.packages, character.only = TRUE)
sapply(packages, require, character.only = TRUE)
# abideDir <- '/Volumes/Xueru/PhDproject/ABIDE' # MAC
abideDir <- 'E:/PhDproject/ABIDE' # Windows
resDir <- file.path(abideDir, "Analysis/Cluster/Spect513")
plotDir <- file.path(abideDir, "Plot/Cluster/Spect513")
resDate <- "240315"
newDate <- "240610"
name <- paste0("Cluster_", newDate, ".csv")
cluster_result <- read.csv(file.path(resDir, name))
##### Part 1: Project the OoS centile (median) for 34 regional volumes in ASD males on brain #######
group1 <- (subset(cluster_result, clusterID == "1"))[, -1:-9]
group2 <- (subset(cluster_result, clusterID == "2"))[, -1:-9]
######################### cluster 1
asd_parc <- group1
median <- apply(asd_parc, 2, median, na.rm = TRUE)
label <- names(asd_parc)
asd_parc_centile <- data.frame(label)
asd_parc_centile$median <- median
asd_parc_centile$label <- paste0("lh_", asd_parc_centile$label)
median <- as.numeric(asd_parc_centile$median)
label <- as.character(asd_parc_centile$label)
ggseg(.data = asd_parc_centile, mapping = aes(fill = median), color = "black", atlas = dk,
hemisphere = "left", size = 1.2) +
theme_void() +
theme(legend.title = element_blank(), legend.position = "bottom",
legend.key.width = unit(1, "cm")) +
# scale_fill_gradient(low = "#7c9d97", high = "white", limits = c(min(median), max(median))) +
scale_fill_gradient(low = "#5378ac", high = "white", limits = c(0.20, 0.40),
breaks = seq(0.20, 0.40, by = 0.05)) +
guides(fill = guide_colourbar(frame.colour = "black", frame.linewidth = 1, ticks = FALSE))
######################### cluster 2
asd_parc <- group2
median <- apply(asd_parc, 2, median, na.rm = TRUE)
label <- names(asd_parc)
asd_parc_centile <- data.frame(label)
asd_parc_centile$median <- median
asd_parc_centile$label <- paste0("lh_", asd_parc_centile$label)
median <- as.numeric(asd_parc_centile$median)
label <- as.character(asd_parc_centile$label)
ggseg(.data = asd_parc_centile, mapping = aes(fill = median), color = "black", atlas = dk,
position = "stacked", hemisphere = "left", size = 1.2) +
theme_void() +
theme(legend.title = element_blank(), legend.position = "bottom",
legend.key.width = unit(1, "cm")) +
# scale_fill_gradient(low = "white", high = "#eab080", limits = c(min(median), max(median))) +
scale_fill_gradient(low = "white", high = "#d26b66", limits = c(0.50, 0.70),
breaks = seq(0.50, 0.70, by = 0.05)) +
guides(fill = guide_colourbar(frame.colour = "black", frame.linewidth = 1, ticks = FALSE))
rm(list=ls())
packages <- c("ggplot2", "ggseg", "ggridges", "tidyr", "do", "dplyr", "Cairo", "openxlsx")
# sapply(packages, install.packages, character.only = TRUE)
sapply(packages, require, character.only = TRUE)
# abideDir <- '/Volumes/Xueru/PhDproject/ABIDE' # MAC
abideDir <- 'E:/PhDproject/ABIDE' # Windows
resDir <- file.path(abideDir, "Analysis/Cluster/Spect510")
plotDir <- file.path(abideDir, "Plot/Cluster/Spect510")
resDate <- "240315"
newDate <- "240610"
name <- paste0("Cluster_", newDate, ".csv")
cluster_result <- read.csv(file.path(resDir, name))
##### Part 1: Project the OoS centile (median) for 34 regional volumes in ASD males on brain #######
group1 <- (subset(cluster_result, clusterID == "2"))[, -1:-9]
group2 <- (subset(cluster_result, clusterID == "1"))[, -1:-9]
######################### cluster 1
asd_parc <- group1
median <- apply(asd_parc, 2, median, na.rm = TRUE)
label <- names(asd_parc)
asd_parc_centile <- data.frame(label)
asd_parc_centile$median <- median
asd_parc_centile$label <- paste0("lh_", asd_parc_centile$label)
name <- paste0("Cluster_1_Centile_", newDate, ".xlsx")
write.xlsx(asd_parc_centile, file.path(resDir, name))
median <- as.numeric(asd_parc_centile$median)
label <- as.character(asd_parc_centile$label)
ggseg(.data = asd_parc_centile, mapping = aes(fill = median), color = "black", atlas = dk,
hemisphere = "left", size = 1.2) +
theme_void() +
theme(legend.title = element_blank(), legend.position = "bottom",
legend.key.width = unit(1, "cm")) +
# scale_fill_gradient(low = "#7c9d97", high = "white", limits = c(min(median), max(median))) +
scale_fill_gradient(low = "#5378ac", high = "white", limits = c(0.16, 0.41),
breaks = seq(0.16, 0.41, by = 0.05)) +
guides(fill = guide_colourbar(frame.colour = "black", frame.linewidth = 1, ticks = FALSE))
