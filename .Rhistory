ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")))
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold"))
View(plot_data)
levels(plot_data$type)
unique(plot_data$type)
# # Vineland的量表是得分越高越好
# plot_data <- plot_data %>%
#   mutate(y_scaled = case_when(
#     type %in% c("sGMV_centile_VINELAND_ABC_Standard", "WMV_centile_VINELAND_COMMUNICATION_STANDARD")
#     ~ -1 * y_scaled,
#     TRUE ~ y_scaled
#   ))
#
#
# 设置 type 的顺序
plot_data <- plot_data %>%
mutate(type = factor(type, levels = c("WMV_centile_VINELAND_ABC_Standard",
"WMV_centile_VINELAND_COMMUNICATION_STANDARDV",
"sGMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD",
"totalSA2_centile_VINELAND_ABC_Standard")))
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_ABC_Standard"] <- "WMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_COMMUNICATION_STANDARDV"] <- "WMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_ABC_Standard"] <- "sGMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "sGMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"totalSA2_centile_VINELAND_ABC_Standard"] <- "SA - 综合分"
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold"))
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#ad5f8a",
"WMV - 沟通" = "#FB9A99",
"sGMV - 综合分" = "black",
"sGMV - 沟通" = "grey",
"SA - 综合分" = "#FF7F00"))
levels(plot_data$type)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#006e54",
"WMV - 沟通" = "#00a381",
"sGMV - 综合分" = "#38b48b",
"sGMV - 沟通" = "#80aba9",
"SA - 综合分" = "#43676b"))
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
packages <- c("tidyverse", "mgcv", "stringr", "reshape2", "magrittr", "ggplot2", "dplyr", "readxl",
"stringr", "ggseg", "patchwork", "effectsize", "pwr", "cowplot",
"readr", "ggridges", "tidyr", "stats", "gamlss", "Cairo")
# sapply(packages,instAll.packages,character.only=TRUE)
sapply(packages, require, character.only = TRUE)
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#006e54",
"WMV - 沟通" = "#00a381",
"sGMV - 综合分" = "#38b48b",
"sGMV - 沟通" = "#80aba9",
"SA - 综合分" = "#43676b"))
dev.off()
##################### Part 1: 画L组 ################################################################
# 创建一个空的数据框来累积所有的绘图数据
plot_data <- data.frame(x = numeric(), y = numeric(), type = character())
for (i in 1:nrow(corr_L)) {
to_plot_names <- c(corr_L[i, "name_brain"], corr_L[i, "name_cog"])
plotPoint_L <- L[, to_plot_names]
plotPoint_L <- plotPoint_L[!is.na(plotPoint_L[[2]]), ]
colnames(plotPoint_L)[1:2] <- c("x","y")
# 添加数据到累积数据框
plotPoint_L$type <- paste0(corr_L[i, "name_brain"], "_", corr_L[i, "name_cog"])
plot_data <- rbind(plot_data, plotPoint_L)
}
grouped_data <- group_by(plot_data, type)
# 给y值都做一下标准化，这样画出的线之间距离不远
plot_data <- mutate(grouped_data, y_scaled = as.numeric(scale(y)))
levels(plot_data$type)
levels(as.factor(plot_data$type))
# # Vineland的量表是得分越高越好
# plot_data <- plot_data %>%
#   mutate(y_scaled = case_when(
#     type %in% c("sGMV_centile_VINELAND_ABC_Standard", "WMV_centile_VINELAND_COMMUNICATION_STANDARD")
#     ~ -1 * y_scaled,
#     TRUE ~ y_scaled
#   ))
#
#
# 设置 type 的顺序
plot_data <- plot_data %>%
mutate(type = factor(type, levels = c("WMV_centile_VINELAND_ABC_Standard",
"WMV_centile_VINELAND_COMMUNICATION_STANDARD",
"sGMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD",
"TCV_centile_VINELAND_ABC_Standard",
"totalSA2_centile_VINELAND_ABC_Standard")))
levels(plot_data$type)
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_ABC_Standard"] <- "WMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "WMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_ABC_Standard"] <- "sGMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "sGMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"TCV_centile_VINELAND_ABC_Standard"] <- "TCV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"totalSA2_centile_VINELAND_ABC_Standard"] <- "SA - 综合分"
# # Vineland的量表是得分越高越好
# plot_data <- plot_data %>%
#   mutate(y_scaled = case_when(
#     type %in% c("sGMV_centile_VINELAND_ABC_Standard", "WMV_centile_VINELAND_COMMUNICATION_STANDARD")
#     ~ -1 * y_scaled,
#     TRUE ~ y_scaled
#   ))
#
#
# 设置 type 的顺序
plot_data <- plot_data %>%
mutate(type = factor(type, levels = c("WMV_centile_VINELAND_COMMUNICATION_STANDARD",
"WMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD",
"TCV_centile_VINELAND_ABC_Standard",
"totalSA2_centile_VINELAND_ABC_Standard")))
# modify name
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_ABC_Standard"] <- "WMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "WMV - 沟通"
##################### Part 1: 画L组 ################################################################
# 创建一个空的数据框来累积所有的绘图数据
plot_data <- data.frame(x = numeric(), y = numeric(), type = character())
for (i in 1:nrow(corr_L)) {
to_plot_names <- c(corr_L[i, "name_brain"], corr_L[i, "name_cog"])
plotPoint_L <- L[, to_plot_names]
plotPoint_L <- plotPoint_L[!is.na(plotPoint_L[[2]]), ]
colnames(plotPoint_L)[1:2] <- c("x","y")
# 添加数据到累积数据框
plotPoint_L$type <- paste0(corr_L[i, "name_brain"], "_", corr_L[i, "name_cog"])
plot_data <- rbind(plot_data, plotPoint_L)
}
grouped_data <- group_by(plot_data, type)
# 给y值都做一下标准化，这样画出的线之间距离不远
plot_data <- mutate(grouped_data, y_scaled = as.numeric(scale(y)))
# # Vineland的量表是得分越高越好
# plot_data <- plot_data %>%
#   mutate(y_scaled = case_when(
#     type %in% c("sGMV_centile_VINELAND_ABC_Standard", "WMV_centile_VINELAND_COMMUNICATION_STANDARD")
#     ~ -1 * y_scaled,
#     TRUE ~ y_scaled
#   ))
#
#
# 设置 type 的顺序
plot_data <- plot_data %>%
mutate(type = factor(type, levels = c("WMV_centile_VINELAND_COMMUNICATION_STANDARD",
"WMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD",
"TCV_centile_VINELAND_ABC_Standard",
"totalSA2_centile_VINELAND_ABC_Standard")))
# modify name
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_ABC_Standard"] <- "WMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "WMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_ABC_Standard"] <- "sGMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "sGMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"TCV_centile_VINELAND_ABC_Standard"] <- "TCV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"totalSA2_centile_VINELAND_ABC_Standard"] <- "SA - 综合分"
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#006e54",
"WMV - 沟通" = "#00a381",
"sGMV - 综合分" = "#38b48b",
"sGMV - 沟通" = "#80aba9",
"TCV - 综合分" = "#5c9291",
"SA - 综合分" = "#43676b"))
dev.off()
plot_data <- data.frame(x = numeric(), y = numeric(), type = character())
for (i in 1:nrow(corr_L)) {
to_plot_names <- c(corr_L[i, "name_brain"], corr_L[i, "name_cog"])
plotPoint_L <- L[, to_plot_names]
plotPoint_L <- plotPoint_L[!is.na(plotPoint_L[[2]]), ]
colnames(plotPoint_L)[1:2] <- c("x","y")
# 添加数据到累积数据框
plotPoint_L$type <- paste0(corr_L[i, "name_brain"], "_", corr_L[i, "name_cog"])
plot_data <- rbind(plot_data, plotPoint_L)
}
grouped_data <- group_by(plot_data, type)
# 给y值都做一下标准化，这样画出的线之间距离不远
plot_data <- mutate(grouped_data, y_scaled = as.numeric(scale(y)))
# # Vineland的量表是得分越高越好
# plot_data <- plot_data %>%
#   mutate(y_scaled = case_when(
#     type %in% c("sGMV_centile_VINELAND_ABC_Standard", "WMV_centile_VINELAND_COMMUNICATION_STANDARD")
#     ~ -1 * y_scaled,
#     TRUE ~ y_scaled
#   ))
#
#
# 设置 type 的顺序
plot_data <- plot_data %>%
mutate(type = factor(type, levels = c("WMV_centile_VINELAND_COMMUNICATION_STANDARD",
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD",
"WMV_centile_VINELAND_ABC_Standard",
"sGMV_centile_VINELAND_ABC_Standard",
"TCV_centile_VINELAND_ABC_Standard",
"totalSA2_centile_VINELAND_ABC_Standard")))
# modify name
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_ABC_Standard"] <- "WMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"WMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "WMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_ABC_Standard"] <- "sGMV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"sGMV_centile_VINELAND_COMMUNICATION_STANDARD"] <- "sGMV - 沟通"
levels(plot_data$type)[levels(plot_data$type) ==
"TCV_centile_VINELAND_ABC_Standard"] <- "TCV - 综合分"
levels(plot_data$type)[levels(plot_data$type) ==
"totalSA2_centile_VINELAND_ABC_Standard"] <- "SA - 综合分"
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#006e54",
"WMV - 沟通" = "#00a381",
"sGMV - 综合分" = "#38b48b",
"sGMV - 沟通" = "#80aba9",
"TCV - 综合分" = "#5c9291",
"SA - 综合分" = "#43676b"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#43676b",
"sGMV - 综合分" = "#80aba9",
"sGMV - 沟通" = "#00a497",
"TCV - 综合分" = "#006e54",
"SA - 综合分" = "#00552e"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
??geom_smooth
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type, linetype = "dashed")) +
geom_smooth(method = "lm", se = FALSE, lwd = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, linetype = "dashed") +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
??linetype
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, linetype = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, linetype = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, linetype = 3) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, linetype = 2) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, alpha = .5) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
name_L <- paste0("GC_corr_Site_L_", newDate, ".png")
CairoPNG(file.path(plotDir, name_L), width = 7, height = 7, units = "in", dpi = 500)
ggplot(plot_data, aes(x = x, y = y_scaled, group = type, color = type)) +
geom_smooth(method = "lm", se = FALSE, lwd = 2, alpha = .5) +
scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
coord_fixed(ratio = .7) +  # 设置坐标轴比例为 1:1
theme_cowplot() +
theme(text = element_text(family = "STSong"),
legend.position = "right",
axis.text.y = element_blank(),    # 去掉y轴文字
axis.ticks.y = element_blank(),  # 去掉y轴刻度
axis.title = element_blank(),
axis.text.x = element_text(size = 15, face = "bold")) +
scale_color_manual(values = c("WMV - 综合分" = "#1f3134",
"WMV - 沟通" = "#00552e",
"sGMV - 综合分" = "#006e54",
"sGMV - 沟通" = "#43676b",
"TCV - 综合分" = "#00a497",
"SA - 综合分" = "#80aba9"))
dev.off()
